/**
* 2010-2014 Tuni-Soft
*
* NOTICE OF LICENSE
*
* This source file is subject to the Academic Free License (AFL 3.0)
* It is available through the world-wide-web at this URL:
* http://opensource.org/licenses/afl-3.0.php
* If you did not receive a copy of the license and are unable to
* obtain it through the world-wide-web, please send an email
* to tunisoft.solutions@gmail.com so we can send you a copy immediately.
*
* DISCLAIMER
*
* Do not edit or add to this file if you wish to upgrade this module to newer
* versions in the future. If you wish to customize the module for your
* needs please refer to
* http://doc.prestashop.com/display/PS15/Overriding+default+behaviors
* for more information.
*
* @author    Tunis-Soft <tunisoft.solutions@gmail.com>
* @copyright 2010-2014 Tuni-Soft
* @license   http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
*/

!function(e,t){function s(e){var t=i(e),s=t.left+e.width()/2,n=t.top+e.height()/2;return[s,n]}function i(e){n(e,0);var t=e.offset();return n(e,e.data("angle")),t}function n(e,t){var s="rotate("+t+"deg)";e.css({"-moz-transform":s,"-o-transform":s,"-webkit-transform":s,"-ms-transform":s,transform:s})}function l(){return u?!1:void 0}function o(e){if(!u)return!1;var t=s(u),i=e.pageX-t[0],l=e.pageY-t[1],o=Math.atan2(l,i),a=o-f+p;return a=d(a),e.shiftKey&&(a=22.5*Math.floor(a/22.5)%360),n(u,a),u.data("angle",a),!1}function a(t){u=e(this).parent();var i=s(u),n=t.pageX-i[0],l=t.pageY-i[1];return f=Math.atan2(l,n),p=h(c(u.data("angle"))),e(document).on("mousemove",o),!1}function r(){return u?(e(document).unbind("mousemove"),setTimeout(function(){u=!1},10),!1):void 0}function c(e){return isNaN(parseFloat(e))?0:parseFloat(e)}function h(e){return e*Math.PI/180}function d(e){return 180*e/Math.PI}e.widget("ui.rotatable",e.ui.mouse,{options:{handle:!1,angle:0},handle:function(e){return e===t?this.options.handle:void(this.options.handle=e)},angle:function(e){return e===t?this.options.angle:(this.options.angle=e,void n(this.element,this.options.angle))},_create:function(){var t;this.options.handle?t=this.options.handle:(t=e(document.createElement("div")),t.addClass("ui-rotatable-handle"),t.attr("title",customtextdesign_rotate)),t.draggable({helper:"clone",start:l}),t.on("mousedown",a),t.appendTo(this.element),0!=this.options.angle&&(this.element.data("angle",this.options.angle),n(this.element,this.options.angle)),e("<div>",{"class":"ft-front ft-control",title:customtextdesign_front}).appendTo(this.element),e("<div>",{"class":"ft-back ft-control",title:customtextdesign_back}).appendTo(this.element),e("<div>",{"class":"ft-suppr ft-control",title:customtextdesign_delete}).appendTo(this.element)},_destroy:function(){this.element.removeClass("ui-rotatable"),this.element.find(".ui-rotatable-handle").remove()}});var u,f,p;e(document).on("mouseup",r)}(jQuery);